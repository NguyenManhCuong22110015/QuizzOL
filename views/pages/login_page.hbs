<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="/css/login.css"/>
    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    
<div class="form-login">
    <form class="" method="post">
        <div class="content">
            <div class="data">
                <h4 class="text-center">Logo</h4>
                <h4 class="text-center"><b>Sign in to your CNN account</b></h4>
                <h5 class="text-center">Don't have an account? <span class="redr" onclick="showFormSignUp()">Sign up</span></h5>
                <div class="mt-4">
                    <input type="text" required name="login_email" />
                    <label placeholder="Adaptive Placeholder" alt="Email address"></label>
                </div>
                <div>
                    <div class="password-container">
                        <input type="password" id="password" name="login_password" placeholder="" required />
                        <label placeholder="Adaptive Placeholder" alt="Enter password"></label>
                        <span id="toggle-password" onclick="togglePassword()">üëÅÔ∏è</span>  
                    </div>
                </div>
                {{#if errorMessage}}
                    <span style="" class="btn btn-danger w-100">{{errorMessage}}</span>
                {{/if}}
                {{#if successMessage}}
                    <span style="" class="btn btn-success w-100">{{successMessage}}</span>
                {{/if}}
                <a class="redr" href="/reset-password">Forgot password?</a><br/>
                <button type="submit" class="submit mt-3" formaction="/auth/login">Sign in</button>
                <div class="divider mt-3">
                    <span>or</span>
                </div>
                <p>By creating an account or signing in, I agree to the Terms of Use and have read our Privacy Policy.</p>
                <div class="login-buttons">
                    <button type="button" class="btn btn-social btn-google" onclick="window.location.href='/auth/google'">
                        <i class="fab fa-google"></i> Continue with Google
                    </button>
                    <button type="button" class="btn btn-social btn-facebook" onclick="window.location.href='/auth/facebook'">
                        <i class="fab fa-facebook-f"></i> Continue with Facebook
                    </button>
                    <button type="button" class="btn btn-social btn-apple" onclick="window.location.href='/auth/github'">
                        <i class="fab fa-github"></i> Continue with Github
                    </button>
                </div>
            </div>
        </div>
    </form>
</div> 

       <div class="modal fade" id="captchaModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Please verify you're human</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                 <form id="captcha-form" action="/verify-captcha" method="POST">
                     <div class="h-captcha" 
                     data-sitekey="f2aacc22-14fa-4572-bc96-0028525e7082"
                     data-callback="onCaptchaVerified">
                </div>
                </form>
               
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
       
        

       <form id="signupForm" class="form-signup" method="post" onsubmit="return validateCaptcha(event)">

            <div class="content">
                <div class="data">
                    <h4 class="text-center" > Logo </h4>
                    <h4 class="text-center"><b>Sign up for your CNN account</b></h4>
                    <h5 class="text-center" >Already have an account? <span class="redr" onclick="showFormLogIn()" > Sign in</span>  </h5>
                    
                    <div class="mt-4">
                        <input type="text" name="reg_email" required />
                        <label placeholder="Adaptive Placeholder" alt="Email address"></label>
                    </div>
                    <div>
                        <div class="password-container">
                            <input type="password" id="password2"  name="reg_password" placeholder=""required />
                            <label placeholder="Adaptive Placeholder" alt="Enter password" ></label>
                            <span id="toggle-password2" onclick="togglePassword2()">üëÅÔ∏è</span>  
                        </div>
                    </div>
                    <p class="sm-txt">By creating an account, I agree to the Terms of Use and have read our Privacy Policy.</p>
                    <label>
                     {{#if errorMessage}}
                         <span style="" class="btn btn-danger w-100">{{errorMessage}}</span>
                     {{/if}}
                    </label>
                    <button type="submit"  class="submit" formaction="/auth/signup" >Create Account</button>
                    <div class="divider mt-3">
                        <span>or</span>
                    </div>
                    
                    <div class="login-buttons">
                        <button type="button" class="btn btn-social btn-google" onclick="window.location.href='/auth/google'">
                        <i class="fab fa-google"></i> Continue with Google
                        </button>
                        <button type="button" class="btn btn-social btn-facebook" onclick="window.location.href='/auth/facebook'" > 
                        <i class="fab fa-facebook-f"></i> Continue with Facebook
                        </button>
                        <button  type="button" class="btn btn-social btn-apple" onclick="window.location.href='/auth/github'" >
                        <i class="fab fa-github"></i> Continue with Github 
                        </button>
                    </div>
                </div>
            </div>
        </form>
    
   


   <script>
    document.addEventListener('DOMContentLoaded', function() {
    const signupForm = document.getElementById('signupForm');
    const captchaModal = new bootstrap.Modal(document.getElementById('captchaModal'));

    if (signupForm) {
        signupForm.addEventListener('submit', function(event) {
            event.preventDefault();
            captchaModal.show();
        });
    }

    window.onCaptchaSuccess = function(token) {
        const form = document.getElementById('signupForm');
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = 'h-captcha-response';
        input.value = token;
        form.appendChild(input);
        form.submit();
    };
});
    function togglePassword() {
      const passwordField = document.getElementById("password");
      const toggleIcon = document.getElementById("toggle-password");
      
      if (passwordField.type === "password") {
        passwordField.type = "text";
        toggleIcon.textContent = "üôà";  
      } else {
        passwordField.type = "password";
        toggleIcon.textContent = "üëÅÔ∏è";  // Tr·ªü l·∫°i icon m·∫Øt khi ·∫©n m·∫≠t kh·∫©u
      }
    }
    function togglePassword2() {
        const passwordField = document.getElementById("password2");
        const toggleIcon = document.getElementById("toggle-password2");
        
        if (passwordField.type === "password") {
          passwordField.type = "text";
          toggleIcon.textContent = "üôà";  
        } else {
          passwordField.type = "password";
          toggleIcon.textContent = "üëÅÔ∏è";  // Tr·ªü l·∫°i icon m·∫Øt khi ·∫©n m·∫≠t kh·∫©u
        }
      }
   
      function showFormLogIn() {
        document.querySelector(".form-login").style.display = "block";
        
        document.querySelector(".form-signup").style.display = "none";
      }
    
      function showFormSignUp() {
        document.querySelector(".form-login").style.display = "none";
        
        document.querySelector(".form-signup").style.display = "block";
      }
window.onCaptchaVerified = function(token) {
    const form = document.getElementById('signupForm');
    const input = document.createElement('input');
    input.type = 'hidden';
    input.name = 'h-captcha-response';
    input.value = token;
    form.appendChild(input);
     form.action = '/auth/signup';
    form.submit();
}

function validateCaptcha(event) {
    event.preventDefault();
    const modal = new bootstrap.Modal(document.getElementById('captchaModal'));
    hcaptcha.render('h-captcha', {
        sitekey: 'f2aacc22-14fa-4572-bc96-0028525e7082'
    });
    modal.show();
    return false;
}

        document.getElementById("getCodeButton").addEventListener("click", function () {
        const emailInput = document.getElementById("emailInput");
        const email = emailInput.value.trim();

        // Ki·ªÉm tra email h·ª£p l·ªá
        if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
            // Hi·ªÉn th·ªã container nh·∫≠p m√£ x√°c th·ª±c
            document.getElementById("twoFactorContainer").classList.remove("hidden");

            // T·ª± ƒë·ªông focus v√†o √¥ ƒë·∫ßu ti√™n
            const inputs = document.querySelectorAll(".code-input");
            inputs[0].focus();

            // Chuy·ªÉn qua √¥ ti·∫øp theo khi nh·∫≠p
            inputs.forEach((input, index) => {
            input.addEventListener("input", () => {
                if (input.value.length === 1 && index < inputs.length - 1) {
                inputs[index + 1].focus();
                }
            });
            });

            // X√≥a √¥ tr∆∞·ªõc khi backspace
            inputs.forEach((input, index) => {
            input.addEventListener("keydown", (e) => {
                if (e.key === "Backspace" && input.value === "" && index > 0) {
                inputs[index - 1].focus();
                }
            });
            });
        } else {
            alert("Please enter a valid email address!");
        }
        });
  </script>
</body>
</html>